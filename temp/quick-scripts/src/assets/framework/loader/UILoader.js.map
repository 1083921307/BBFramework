{"version":3,"sources":["assets\\framework\\loader\\UILoader.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nexport default class UILoader {\r\n    static singleInstance: UILoader = null;\r\n    static getInstance(): UILoader {\r\n        if (UILoader.singleInstance == null) {\r\n            UILoader.singleInstance = new UILoader();\r\n        }\r\n        return UILoader.singleInstance;\r\n    }\r\n\r\n    // 资源加载到内存不会进行引用计数管理\r\n    loadRes(url: string, type: typeof cc.Asset, callback): void {\r\n        if (!url || !type || !callback) {\r\n            cc.log(\"参数错误\");\r\n            return;\r\n        }\r\n\r\n        cc.loader.loadRes(url, type, (err, asset) => {\r\n            if (err) {\r\n                cc.log(`[资源加载] 错误 ${err}`);\r\n                return;\r\n            }\r\n            callback(asset);\r\n        });\r\n    }\r\n\r\n    loadResArr(paths: Array<string>, callfun: Function) {\r\n        cc.loader.loadResArray(paths, function(err, assets){\r\n            if (err) {\r\n                cc.log(err);\r\n                return;\r\n            }\r\n            callfun(assets);\r\n        }.bind(this));\r\n    }\r\n\r\n   \r\n    loadStaticRes(url: string, type: typeof cc.Asset, tag: string, callback) {\r\n        if (!url || !type || !callback) {\r\n            cc.log(\"参数错误\");\r\n            return;\r\n        }\r\n        cc.loader.loadRes(url, type, (err, asset) => {\r\n            callback(asset);\r\n            this._parseStaticRes(asset, tag);\r\n        });\r\n    }\r\n\r\n    loadStaticResArr(paths: Array<string>, tag: string, callfun: Function) {\r\n        if (!paths || !tag || !callfun) {\r\n            cc.log(\"参数错误\");\r\n            return;\r\n        }\r\n\r\n        cc.loader.loadResArray(paths, function(err, assets){\r\n            if (err) {\r\n                cc.log(err);\r\n                return;\r\n            }\r\n            callfun(assets);\r\n            assets.forEach((asset) => {\r\n                this._parseStaticRes(asset, tag);\r\n            });\r\n        }.bind(this));\r\n    }\r\n\r\n\r\n    \r\n    loadAudioClip(path: string, callfun) {\r\n        cc.loader.loadRes(path, cc.AudioClip, (err, audioclip) => {\r\n            if (err) {\r\n                cc.log(err);\r\n                return;\r\n            }\r\n            callfun(audioclip);\r\n        });\r\n    }\r\n\r\n    loadSpriteFrame(path: string, callfun: Function, retainRes: boolean = false) {\r\n        cc.loader.loadRes(path, cc.SpriteFrame, (err, spriteFrame) => {\r\n            if (err) {\r\n                cc.log(err);\r\n                return;\r\n            }\r\n            if (retainRes) {\r\n                this.retatinRes(spriteFrame._textureFilename);\r\n            }\r\n            callfun(spriteFrame);\r\n        });\r\n    }\r\n\r\n\r\n    loadSpriteFrames(paths: Array<string>, callfun: Function, retainRes: boolean = false) {\r\n        cc.loader.loadResArray(paths, cc.SpriteFrame, function(err, spriteFrames){\r\n            if (err) {\r\n                cc.log(err);\r\n                return;\r\n            }\r\n            if (retainRes) {\r\n                spriteFrames.forEach((spriteFrame) => {\r\n                    this.retatinRes(spriteFrame._textureFilename);\r\n                });\r\n                \r\n            }\r\n            callfun(spriteFrames);\r\n        }.bind(this));\r\n    }\r\n\r\n    \r\n    releaseMusicRes(res: string): void {\r\n        this.releaseRes(res);\r\n        this.gc();\r\n    }\r\n\r\n\r\n\r\n    releaseStaticRes(tag: string): void {\r\n        var texturesInCache = cc.loader[\"_cache\"];\r\n        var release_key = [];\r\n        for (var asset in texturesInCache) {\r\n            if (tag && texturesInCache[asset].uTag !== tag) {\r\n                continue;\r\n            }\r\n           \r\n            if (texturesInCache[asset].bk_count > 0 && texturesInCache[asset].uStatic) {\r\n                // 移除 Static 标识, \r\n                texturesInCache[asset].uStatic == null;\r\n                delete texturesInCache[asset].uStatic;\r\n                continue;\r\n            }\r\n\r\n            if (texturesInCache[asset].bk_count <= 0) {\r\n                release_key.push(texturesInCache[asset].url);\r\n                cc.log(`释放资源:${texturesInCache[asset].url}`);\r\n                cc.loader.release(texturesInCache[asset].url);\r\n            }\r\n        }\r\n\r\n        if (release_key.length > 0) {\r\n            this._depthGC(release_key);\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n    getCacheCount() {\r\n        return Object.keys(cc.loader[\"_cache\"]).length;\r\n    }\r\n\r\n  \r\n\r\n    retatinRes(res: string) {\r\n        if (!cc.loader[\"_cache\"][res]) {\r\n            return;\r\n        }\r\n\r\n        if (!cc.loader[\"_cache\"][res].bk_count) {\r\n            cc.loader[\"_cache\"][res].bk_count = 0;\r\n        }\r\n        cc.loader[\"_cache\"][res].bk_count += 1;\r\n    }\r\n\r\n    retainArrayRes(res: string[]) {\r\n        res.forEach((item) => {\r\n            this.retatinRes(item);\r\n        });\r\n    }\r\n\r\n    retainNodeRes(node: cc.Node) {\r\n        this._parserNodeRes(node, 1);\r\n    }\r\n\r\n    releaseNodeRes(node: cc.Node) {\r\n        this._parserNodeRes(node, -1);\r\n    }\r\n\r\n    releaseRes(res: string) {\r\n        if (!cc.loader[\"_cache\"][res]) {\r\n            return;\r\n        }\r\n\r\n        if (!cc.loader[\"_cache\"][res].bk_count) {\r\n            cc.loader[\"_cache\"][res].bk_count = 0;\r\n        }\r\n        cc.loader[\"_cache\"][res].bk_count -= 1;\r\n    }\r\n\r\n    releaseArrayRes(res: string[]) {\r\n        res.forEach((item) => {\r\n            this.releaseRes(item);\r\n        });\r\n    }\r\n\r\n    \r\n   \r\n\r\n    gc(){\r\n        var texturesInCache = cc.loader[\"_cache\"];\r\n        var release_key = [];\r\n        for (var asset in texturesInCache) {\r\n            if (texturesInCache[asset].uStatic) {\r\n                continue;\r\n            }\r\n            if (texturesInCache[asset].bk_count <= 0) {\r\n                release_key.push(texturesInCache[asset].url);\r\n                cc.log(`释放资源:${texturesInCache[asset].url}`);\r\n                cc.loader.release(texturesInCache[asset].url);\r\n            }\r\n        }\r\n\r\n        if (release_key.length > 0) {\r\n            this._depthGC(release_key);\r\n        }\r\n    }\r\n\r\n\r\n    updateSpriteTexture(target: cc.Node, spriteFrame: cc.SpriteFrame) {\r\n        if (!target || !spriteFrame || !target.getComponent(cc.Sprite)) {\r\n            return;\r\n        }\r\n        let sprite = target.getComponent(cc.Sprite);\r\n        this._replaceTagetTexture(sprite, \"spriteFrame\", spriteFrame);\r\n        this.gc();\r\n    }\r\n\r\n    updateButtonTexture(target: cc.Node, normalSprite?: cc.SpriteFrame, pressedSprite?: cc.SpriteFrame, hoverSprite?: cc.SpriteFrame, disabledSprite?: cc.SpriteFrame) {\r\n        if (!target || !normalSprite) {\r\n            cc.log(\"参数错误\")\r\n            return;\r\n        }\r\n\r\n        if (!target.getComponent(cc.Button)) {\r\n            cc.log(\"目标节点没有Button组件\");\r\n            return;\r\n        }\r\n\r\n        let button = target.getComponent(cc.Button);\r\n        if (normalSprite) {\r\n            this._replaceTagetTexture(button, \"normalSprite\", normalSprite);\r\n        }\r\n\r\n        if (pressedSprite) {\r\n            this._replaceTagetTexture(button, \"pressedSprite\", pressedSprite);\r\n        }\r\n\r\n        if (hoverSprite) {\r\n            this._replaceTagetTexture(button, \"hoverSprite\", hoverSprite);\r\n        }\r\n\r\n        if (disabledSprite) {\r\n            this._replaceTagetTexture(button, \"disabledSprite\", disabledSprite);\r\n        }\r\n        this.gc();\r\n    }\r\n\r\n    _depthGC(strs: Array<string>) {\r\n        var texturesInCache = cc.loader[\"_cache\"];\r\n        var release_json = [];\r\n        for (var asset in texturesInCache) {\r\n            if (texturesInCache[asset].dependKeys && texturesInCache[asset].dependKeys.length > 0) {\r\n                var is_release = false;\r\n                for (var i = 0; i < texturesInCache[asset].dependKeys.length; i++) {\r\n                    if (strs.indexOf(texturesInCache[asset].dependKeys[i]) !== -1) {\r\n                        is_release = true;\r\n                    }\r\n                }\r\n                if (is_release /*&& texturesInCache[asset].bk_count <= 0*/) {\r\n                    release_json.push(texturesInCache[asset].url);\r\n                    cc.log(`释放资源:${texturesInCache[asset].url}`);\r\n                    cc.loader.release(texturesInCache[asset].url);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (release_json.length > 0) {\r\n            this._depthGC(release_json);\r\n        }\r\n    }\r\n\r\n\r\n    _parseStaticRes(item:  typeof cc.Asset, tag: string) {\r\n        if (item instanceof cc.Texture2D) {\r\n            cc.loader[\"_cache\"][item.url].uStatic = true;\r\n            cc.loader[\"_cache\"][item.url].uTag = tag;\r\n        } else if (item instanceof cc.SpriteFrame) {\r\n            cc.loader[\"_cache\"][item[\"_textureFilename\"]].uStatic = true;\r\n            cc.loader[\"_cache\"][item[\"_textureFilename\"]].uTag = tag;\r\n        } else if (item instanceof cc.Prefab) {\r\n            this._parseStaticPrefab(item, tag);\r\n        } else if (item instanceof cc.BitmapFont) {\r\n            cc.loader[\"_cache\"][item[\"spriteFrame\"]._textureFilename].uStatic = true;\r\n            cc.loader[\"_cache\"][item[\"spriteFrame\"]._textureFilename].uTag = tag;\r\n        } else if (item instanceof cc.SpriteAtlas) {\r\n            var keys = Object.keys(item[\"_spriteFrames\"])\r\n            keys.forEach((key) => {\r\n                cc.loader[\"_cache\"][item[\"_spriteFrames\"][key]._textureFilename].uStatic = true;\r\n                cc.loader[\"_cache\"][item[\"_spriteFrames\"][key]._textureFilename].uTag = tag;\r\n            });\r\n        } else if (item instanceof cc.AnimationClip) {\r\n            cc.log('AnimationClip 资源加载未做处理');\r\n        } else if (item instanceof Object && item[\"name\"]) {\r\n            cc.log('Object 资源加载未做处理');\r\n        }\r\n    }\r\n\r\n    _parseStaticPrefab(node, tag: string) {\r\n        var prefab = node;\r\n        if (node.data) {\r\n            prefab = node.data;\r\n        }\r\n    \r\n        if (!(prefab instanceof cc.Scene)) {\r\n            this._parseStaticNode(prefab, tag);\r\n        }\r\n        let children = prefab._children;\r\n        children.forEach((child) => {\r\n            this._parseStaticNode(child, tag);\r\n            this._parseStaticPrefab(child, tag);\r\n        });\r\n    }\r\n\r\n    _retatinStaticRes(res: string, tag: string) {\r\n        if (!cc.loader[\"_cache\"][res]) {\r\n            return;\r\n        }\r\n\r\n        if (!cc.loader[\"_cache\"][res].bk_count) {\r\n            cc.loader[\"_cache\"][res].bk_count = 0;\r\n        }\r\n        cc.loader[\"_cache\"][res].uStatic = true;\r\n        cc.loader[\"_cache\"][res].uTag = tag;\r\n    }\r\n\r\n    _parseStaticNode(node: cc.Node, tag: string) {\r\n        // sprite 组件\r\n        let sprite = node.getComponent(cc.Sprite);\r\n        if (sprite && sprite.spriteFrame) {\r\n            this._retatinStaticRes(sprite.spriteFrame[\"_textureFilename\"], tag);\r\n        }\r\n    \r\n        // button 组件\r\n        let button = node.getComponent(cc.Button);\r\n        if (button && button.normalSprite) {\r\n            this._retatinStaticRes(button.normalSprite[\"_textureFilename\"], tag);\r\n        }\r\n        if (button && button.pressedSprite) {\r\n            this._retatinStaticRes(button.pressedSprite[\"_textureFilename\"], tag);\r\n        }\r\n        if (button && button.hoverSprite) {\r\n            this._retatinStaticRes(button.hoverSprite[\"_textureFilename\"], tag);\r\n        }\r\n        if (button && button.disabledSprite) {\r\n            this._retatinStaticRes(button.disabledSprite[\"_textureFilename\"], tag);\r\n        }\r\n        \r\n        // label 组件\r\n        let label = node.getComponent(cc.Label);\r\n        if (label && label.font && label.font instanceof cc.BitmapFont && label.font[\"spriteFrame\"]) {\r\n            this._retatinStaticRes(label.font[\"spriteFrame\"]._textureFilename, tag);\r\n        }\r\n    \r\n        // richText 组件\r\n        let richText = node.getComponent(cc.RichText);\r\n        if (richText && richText.imageAtlas) {\r\n            let keys = Object.keys(richText.imageAtlas[\"_spriteFrames\"]);\r\n            if (keys.length > 0) {\r\n                this._retatinStaticRes(richText.imageAtlas[\"_spriteFrames\"][keys[0]]._textureFilename, tag);\r\n            }\r\n        }\r\n\r\n        // particleSystem 组件\r\n        let particleSystem = node.getComponent(cc.ParticleSystem);\r\n        if (particleSystem && particleSystem[\"_texture\"]) {\r\n            this._retatinStaticRes(particleSystem[\"_texture\"], tag);\r\n        }\r\n    \r\n        // pageViewIndicator 组件\r\n        let pageViewIndicator = node.getComponent(cc.PageViewIndicator);\r\n        if (pageViewIndicator && pageViewIndicator.spriteFrame) {\r\n            this._retatinStaticRes(pageViewIndicator.spriteFrame[\"_textureFilename\"], tag);\r\n        }\r\n    \r\n        // editBox 组件\r\n        let editBox = node.getComponent(cc.EditBox);\r\n        if (editBox && editBox.backgroundImage) {\r\n            this._retatinStaticRes(editBox.backgroundImage[\"_textureFilename\"], tag);\r\n        }\r\n    \r\n        // Mask\r\n        let mask = node.getComponent(cc.Mask);\r\n        if (mask && mask.spriteFrame) {\r\n            this._retatinStaticRes(mask.spriteFrame[\"_textureFilename\"], tag);\r\n        }\r\n    }\r\n\r\n\r\n\r\n    _replaceTagetTexture(target: any, attrName: string, newNormalSprite: cc.SpriteFrame) {\r\n        if (target[attrName] === newNormalSprite) {\r\n            return;\r\n        }\r\n        if (target[attrName]) {\r\n            this.releaseRes(target[attrName]._textureFilename);\r\n        }\r\n        this.retatinRes(newNormalSprite[\"_textureFilename\"]);\r\n        target[attrName] = newNormalSprite;\r\n    }\r\n\r\n    _parserNodeRes(node: cc.Node, number: number) {\r\n        let children = node.children;\r\n        this._parserNodeComponentRes(node, number);\r\n        children.forEach((child) => {\r\n            this._parserNodeRes(child, number);\r\n        });\r\n    }\r\n\r\n    _parserNodeComponentRes(node: cc.Node, num: number) {\r\n        this._parserComponentSprite(node, num);\r\n        this._parserComponentButton(node, num);\r\n        this._parserComponentLabel(node, num);\r\n        this._parserComponentRichText(node, num);\r\n        this._parserComponentParticleSystem(node, num);\r\n        this._parserComponentPageViewIndicator(node, num);\r\n        this._parserComponentEditBox(node, num);\r\n        this._parserComponentMask(node, num);\r\n\r\n        // TODO 释放其他组件附带的资源\r\n    }\r\n\r\n    _parserComponentSprite(node: cc.Node, num: number) {\r\n        let sprite = node.getComponent(cc.Sprite);\r\n        if (!sprite) {\r\n            return;\r\n        }\r\n        if (num > 0) {\r\n            this.retatinRes(sprite.spriteFrame[\"_textureFilename\"]);\r\n            return;\r\n        }\r\n        this.releaseRes(sprite.spriteFrame[\"_textureFilename\"]);\r\n    }\r\n\r\n    _parserComponentButton(node: cc.Node, num: number) {\r\n        let button = node.getComponent(cc.Button);\r\n        if (!button) {\r\n            return;\r\n        }\r\n\r\n        if (button.normalSprite) {\r\n            if (num > 0) {\r\n                this.retatinRes(button.normalSprite[\"_textureFilename\"]);\r\n            } else {\r\n                this.releaseRes(button.normalSprite[\"_textureFilename\"]);\r\n            }\r\n        }\r\n\r\n        if (button.pressedSprite) {\r\n            if (num > 0) {\r\n                this.retatinRes(button.pressedSprite[\"_textureFilename\"]);\r\n            } else {\r\n                this.releaseRes(button.pressedSprite[\"_textureFilename\"]);\r\n            }\r\n           \r\n        }\r\n\r\n        if (button.hoverSprite) {\r\n            if (num > 0) {\r\n                this.retatinRes(button.hoverSprite[\"_textureFilename\"]);\r\n            } else {\r\n                this.releaseRes(button.hoverSprite[\"_textureFilename\"]);\r\n            }\r\n        }\r\n\r\n        if (button.disabledSprite) {\r\n            if (num > 0) {\r\n                this.retatinRes(button.disabledSprite[\"_textureFilename\"]);\r\n            } else {\r\n                this.releaseRes(button.disabledSprite[\"_textureFilename\"]);\r\n            }\r\n        }\r\n    }\r\n\r\n    _parserComponentLabel(node: cc.Node, num: number) {\r\n        let label = node.getComponent(cc.Label);\r\n        if (!label || !label.font || !(label.font instanceof cc.BitmapFont) || !label.font[\"spriteFrame\"]) {\r\n            return;\r\n        }\r\n\r\n        if (num > 0) {\r\n            this.retatinRes(label.font[\"spriteFrame\"][\"_textureFilename\"]);\r\n            return;\r\n        }\r\n        this.releaseRes(label.font[\"spriteFrame\"][\"_textureFilename\"]);\r\n    }\r\n\r\n    _parserComponentRichText(node: cc.Node, num: number) {\r\n        let richText = node.getComponent(cc.RichText);\r\n        if (!richText || !richText.imageAtlas) {\r\n            return;\r\n        }\r\n\r\n        let keys = Object.keys(richText.imageAtlas[\"_spriteFrames\"]);\r\n        if (keys.length <= 0) {\r\n            return;\r\n        }\r\n\r\n        if (num > 0) {\r\n            this.retatinRes(richText.imageAtlas[\"_spriteFrames\"][keys[0]][\"_textureFilename\"]);\r\n            return;\r\n        }\r\n        this.releaseRes(richText.imageAtlas[\"_spriteFrames\"][keys[0]][\"_textureFilename\"]);\r\n    }\r\n\r\n    _parserComponentParticleSystem(node: cc.Node, num: number){\r\n        let particleSystem = node.getComponent(cc.ParticleSystem);\r\n        if (!particleSystem || !particleSystem[\"_texture\"]) {\r\n            return;\r\n        }\r\n\r\n        if (num > 0) {\r\n            this.retatinRes(particleSystem[\"_texture\"]);\r\n            return;\r\n        }\r\n        this.releaseRes(particleSystem[\"_texture\"]);\r\n    }\r\n\r\n    _parserComponentPageViewIndicator(node: cc.Node, num: number) {\r\n        let pageViewIndicator = node.getComponent(cc.PageViewIndicator);\r\n        if (!pageViewIndicator || !pageViewIndicator.spriteFrame) {\r\n           return;\r\n        }\r\n\r\n        if (num > 0) {\r\n            this.retatinRes(pageViewIndicator.spriteFrame[\"_textureFilename\"]);\r\n            return;\r\n        }\r\n        this.releaseRes(pageViewIndicator.spriteFrame[\"_textureFilename\"]);\r\n    }\r\n\r\n    _parserComponentEditBox(node: cc.Node, num: number) {\r\n        let editBox = node.getComponent(cc.EditBox);\r\n        if (!editBox || !editBox.backgroundImage) {\r\n            return;\r\n        }\r\n\r\n        if (num > 0) {\r\n            this.retatinRes(editBox.backgroundImage[\"_textureFilename\"]);\r\n            return;\r\n        }\r\n        this.releaseRes(editBox.backgroundImage[\"_textureFilename\"]);\r\n    }\r\n\r\n    _parserComponentMask(node: cc.Node, num: number) {\r\n        let mask = node.getComponent(cc.Mask);\r\n        if (!mask || !mask.spriteFrame) {\r\n            return;\r\n        }\r\n\r\n        if (num > 0) {\r\n            this.retatinRes(mask.spriteFrame[\"_textureFilename\"]);\r\n            return;\r\n        }\r\n        this.releaseRes(mask.spriteFrame[\"_textureFilename\"]);\r\n\r\n    }\r\n}"]}